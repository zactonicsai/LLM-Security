<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Local LLM Security Checklist & Guidance</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'display': ['Space Grotesk', 'sans-serif'],
            'mono': ['JetBrains Mono', 'monospace'],
            'body': ['IBM Plex Sans', 'sans-serif'],
          },
          colors: {
            cyber: {
              900: '#0a0e17',
              800: '#0f1629',
              700: '#151d35',
              600: '#1c2642',
              500: '#243354',
              400: '#2d4066',
              300: '#3d5a80',
              200: '#5c7a99',
              100: '#8fa7bf',
            },
            accent: {
              cyan: '#00d4ff',
              green: '#00ff88',
              amber: '#ffb800',
              red: '#ff3d57',
              purple: '#a855f7',
            }
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
            'scan': 'scan 3s linear infinite',
            'fade-in': 'fadeIn 0.5s ease-out forwards',
            'slide-in': 'slideIn 0.4s ease-out forwards',
            'slide-up': 'slideUp 0.3s ease-out forwards',
          },
          keyframes: {
            glow: {
              '0%': { boxShadow: '0 0 5px rgba(0, 212, 255, 0.3), 0 0 10px rgba(0, 212, 255, 0.2)' },
              '100%': { boxShadow: '0 0 10px rgba(0, 212, 255, 0.5), 0 0 20px rgba(0, 212, 255, 0.3)' },
            },
            scan: {
              '0%': { transform: 'translateY(-100%)' },
              '100%': { transform: 'translateY(100%)' },
            },
            fadeIn: {
              '0%': { opacity: '0', transform: 'translateY(10px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            },
            slideIn: {
              '0%': { opacity: '0', transform: 'translateX(-20px)' },
              '100%': { opacity: '1', transform: 'translateX(0)' },
            },
            slideUp: {
              '0%': { opacity: '0', transform: 'translateY(20px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            }
          }
        }
      }
    }
  </script>
  <style>
    * { scrollbar-width: thin; scrollbar-color: #3d5a80 #0f1629; }
    *::-webkit-scrollbar { width: 6px; height: 6px; }
    *::-webkit-scrollbar-track { background: #0f1629; }
    *::-webkit-scrollbar-thumb { background: #3d5a80; border-radius: 4px; }
    *::-webkit-scrollbar-thumb:hover { background: #5c7a99; }
    
    html { scroll-behavior: smooth; }
    
    body { 
      -webkit-tap-highlight-color: transparent;
      overscroll-behavior: none;
    }
    
    .grid-bg {
      background-image: 
        linear-gradient(rgba(0, 212, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 212, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }
    
    .glow-border {
      box-shadow: 0 0 0 1px rgba(0, 212, 255, 0.2), 
                  inset 0 0 20px rgba(0, 212, 255, 0.05),
                  0 0 30px rgba(0, 212, 255, 0.1);
    }
    
    .status-critical { border-left: 3px solid #ff3d57; }
    .status-high { border-left: 3px solid #ffb800; }
    .status-medium { border-left: 3px solid #a855f7; }
    .status-low { border-left: 3px solid #00ff88; }
    
    .checklist-item.completed { opacity: 0.7; }
    .checklist-item.completed .item-title { text-decoration: line-through; color: #5c7a99; }
    
    .toc-item.active { 
      background: linear-gradient(90deg, rgba(0, 212, 255, 0.15), transparent);
      border-left: 2px solid #00d4ff;
    }
    
    .noise-overlay {
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.03;
      pointer-events: none;
    }
    
    input[type="checkbox"] {
      appearance: none;
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      min-width: 24px;
      border: 2px solid #3d5a80;
      border-radius: 6px;
      background: #0f1629;
      cursor: pointer;
      position: relative;
      transition: all 0.2s ease;
    }
    
    @media (min-width: 768px) {
      input[type="checkbox"] {
        width: 20px;
        height: 20px;
        min-width: 20px;
        border-radius: 4px;
      }
    }
    
    input[type="checkbox"]:checked {
      background: linear-gradient(135deg, #00d4ff, #00ff88);
      border-color: #00d4ff;
    }
    
    input[type="checkbox"]:checked::after {
      content: 'âœ“';
      position: absolute;
      color: #0a0e17;
      font-weight: bold;
      font-size: 14px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    
    textarea, input[type="text"] {
      background: #0f1629;
      border: 1px solid #243354;
      color: #8fa7bf;
      transition: all 0.2s ease;
      font-size: 16px; /* Prevents zoom on iOS */
    }
    
    textarea:focus, input[type="text"]:focus {
      outline: none;
      border-color: #00d4ff;
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.2);
    }
    
    .progress-ring { transform: rotate(-90deg); }
    
    .section-content { display: none; }
    .section-content.active { display: block; animation: fadeIn 0.3s ease-out; }
    
    /* Mobile sidebar overlay */
    .sidebar-overlay {
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    .sidebar-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    /* Mobile sidebar */
    .mobile-sidebar {
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }
    
    .mobile-sidebar.active {
      transform: translateX(0);
    }
    
    /* Tips panel mobile */
    @media (max-width: 767px) {
      #tips-panel {
        width: 100%;
        top: 0;
        border-left: none;
        border-radius: 0;
      }
    }
    
    /* Touch-friendly buttons */
    .touch-target {
      min-height: 44px;
      min-width: 44px;
    }
    
    /* Bottom action bar for mobile */
    .mobile-action-bar {
      padding-bottom: env(safe-area-inset-bottom, 0);
    }
    
    /* Fix for iOS momentum scrolling */
    .scroll-container {
      -webkit-overflow-scrolling: touch;
    }
  </style>
</head>
<body class="bg-cyber-900 text-cyber-100 font-body min-h-screen grid-bg">
  <!-- Noise overlay -->
  <div class="fixed inset-0 noise-overlay"></div>
  
  <!-- Mobile Sidebar Overlay -->
  <div id="sidebar-overlay" class="sidebar-overlay fixed inset-0 bg-black/60 backdrop-blur-sm z-40 md:hidden" onclick="closeSidebar()"></div>
  
  <!-- Header -->
  <header class="fixed top-0 left-0 right-0 z-50 bg-cyber-900/95 backdrop-blur-sm border-b border-cyber-600">
    <div class="max-w-[1800px] mx-auto px-3 md:px-6 py-3 md:py-4">
      <!-- Mobile Header -->
      <div class="flex items-center justify-between md:hidden">
        <button onclick="toggleSidebar()" class="touch-target p-2 -ml-2 hover:bg-cyber-700 rounded-lg transition-colors">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
        
        <div class="flex items-center gap-2">
          <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-accent-cyan to-accent-green flex items-center justify-center">
            <svg class="w-5 h-5 text-cyber-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
            </svg>
          </div>
          <span class="font-display font-bold text-sm text-white">LLM Security</span>
        </div>
        
        <!-- Mobile Progress -->
        <div class="flex items-center gap-2">
          <span class="font-mono text-sm font-bold text-accent-cyan" id="mobile-progress-percent">0%</span>
        </div>
      </div>
      
      <!-- Desktop Header -->
      <div class="hidden md:flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-accent-cyan to-accent-green flex items-center justify-center">
            <svg class="w-6 h-6 text-cyber-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
            </svg>
          </div>
          <div>
            <h1 class="font-display font-bold text-xl text-white">LLM Security Checklist</h1>
            <p class="text-xs text-cyber-200 font-mono">Local Deployment Security Assessment Tool</p>
          </div>
        </div>
        
        <div class="flex items-center gap-3">
          <!-- Progress indicator -->
          <div class="flex items-center gap-3 px-4 py-2 bg-cyber-800 rounded-lg border border-cyber-600">
            <svg class="w-12 h-12 progress-ring" viewBox="0 0 36 36">
              <path class="text-cyber-700" stroke="currentColor" stroke-width="3" fill="none" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
              <path id="progress-circle" class="text-accent-cyan" stroke="currentColor" stroke-width="3" fill="none" stroke-linecap="round" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
            </svg>
            <div class="text-center">
              <div class="font-mono text-xl font-bold text-white" id="progress-percent">0%</div>
              <div class="text-xs text-cyber-200">Complete</div>
            </div>
          </div>
          
          <!-- Action buttons -->
          <button onclick="exportData()" class="px-4 py-2 bg-cyber-700 hover:bg-cyber-600 border border-cyber-500 rounded-lg font-mono text-sm transition-all flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
            Export
          </button>
          <label class="px-4 py-2 bg-cyber-700 hover:bg-cyber-600 border border-cyber-500 rounded-lg font-mono text-sm transition-all flex items-center gap-2 cursor-pointer">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
            Import
            <input type="file" accept=".json" onchange="importData(event)" class="hidden">
          </label>
          <button onclick="resetData()" class="px-4 py-2 bg-accent-red/20 hover:bg-accent-red/30 border border-accent-red/50 text-accent-red rounded-lg font-mono text-sm transition-all">
            Reset
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Sidebar -->
  <aside id="mobile-sidebar" class="mobile-sidebar fixed left-0 top-0 bottom-0 w-[85%] max-w-[320px] bg-cyber-800 border-r border-cyber-600 z-50 md:hidden overflow-hidden flex flex-col">
    <!-- Sidebar Header -->
    <div class="p-4 border-b border-cyber-600 flex items-center justify-between">
      <h2 class="font-display font-semibold text-white">Menu</h2>
      <button onclick="closeSidebar()" class="touch-target p-2 -mr-2 hover:bg-cyber-700 rounded-lg">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
      </button>
    </div>
    
    <!-- TOC Navigation -->
    <nav id="mobile-toc-nav" class="flex-1 overflow-y-auto scroll-container p-3 space-y-1">
      <!-- Populated by JS -->
    </nav>
    
    <!-- Mobile Stats -->
    <div class="p-4 border-t border-cyber-600 bg-cyber-900/50">
      <h3 class="font-display font-semibold text-xs text-cyber-200 uppercase tracking-wider mb-3">Progress</h3>
      <div class="grid grid-cols-2 gap-2 text-sm">
        <div class="flex justify-between">
          <span class="text-cyber-300">Critical</span>
          <span id="mobile-stat-critical" class="font-mono text-accent-red">0/0</span>
        </div>
        <div class="flex justify-between">
          <span class="text-cyber-300">High</span>
          <span id="mobile-stat-high" class="font-mono text-accent-amber">0/0</span>
        </div>
        <div class="flex justify-between">
          <span class="text-cyber-300">Medium</span>
          <span id="mobile-stat-medium" class="font-mono text-accent-purple">0/0</span>
        </div>
        <div class="flex justify-between">
          <span class="text-cyber-300">Low</span>
          <span id="mobile-stat-low" class="font-mono text-accent-green">0/0</span>
        </div>
      </div>
    </div>
  </aside>

  <!-- Desktop Sidebar -->
  <aside class="hidden md:block fixed left-0 top-[73px] bottom-0 w-72 bg-cyber-800/50 border-r border-cyber-600 overflow-y-auto scroll-container">
    <div class="p-4">
      <h2 class="font-display font-semibold text-sm text-cyber-200 uppercase tracking-wider mb-4 flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/></svg>
        Table of Contents
      </h2>
      <nav id="toc-nav" class="space-y-1">
        <!-- TOC items populated by JS -->
      </nav>
    </div>
    
    <!-- Stats panel -->
    <div class="p-4 border-t border-cyber-600">
      <h3 class="font-display font-semibold text-sm text-cyber-200 uppercase tracking-wider mb-3">Statistics</h3>
      <div class="space-y-3">
        <div class="flex justify-between items-center">
          <span class="text-sm text-cyber-300">Critical Items</span>
          <span id="stat-critical" class="font-mono text-accent-red">0/0</span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-sm text-cyber-300">High Priority</span>
          <span id="stat-high" class="font-mono text-accent-amber">0/0</span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-sm text-cyber-300">Medium Priority</span>
          <span id="stat-medium" class="font-mono text-accent-purple">0/0</span>
        </div>
        <div class="flex justify-between items-center">
          <span class="text-sm text-cyber-300">Low Priority</span>
          <span id="stat-low" class="font-mono text-accent-green">0/0</span>
        </div>
      </div>
    </div>
  </aside>

  <!-- Main content area -->
  <main class="md:ml-72 pt-16 md:pt-24 pb-24 md:pb-8">
    <div class="max-w-5xl mx-auto px-3 md:px-6" id="main-content">
      <!-- Content sections populated by JS -->
    </div>
  </main>

  <!-- Mobile Bottom Action Bar -->
  <div class="mobile-action-bar fixed bottom-0 left-0 right-0 bg-cyber-800/95 backdrop-blur-sm border-t border-cyber-600 p-3 md:hidden z-30">
    <div class="flex items-center justify-around gap-2">
      <button onclick="exportData()" class="touch-target flex-1 py-3 bg-cyber-700 hover:bg-cyber-600 border border-cyber-500 rounded-lg font-mono text-xs transition-all flex flex-col items-center gap-1">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
        Export
      </button>
      <label class="touch-target flex-1 py-3 bg-cyber-700 hover:bg-cyber-600 border border-cyber-500 rounded-lg font-mono text-xs transition-all flex flex-col items-center gap-1 cursor-pointer">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
        Import
        <input type="file" accept=".json" onchange="importData(event)" class="hidden">
      </label>
      <button onclick="resetData()" class="touch-target flex-1 py-3 bg-accent-red/20 hover:bg-accent-red/30 border border-accent-red/50 text-accent-red rounded-lg font-mono text-xs transition-all flex flex-col items-center gap-1">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
        Reset
      </button>
    </div>
  </div>

  <!-- Toast notifications -->
  <div id="toast-container" class="fixed bottom-20 md:bottom-6 right-3 md:right-6 left-3 md:left-auto z-50 space-y-2"></div>

  <!-- Comment Modal -->
  <div id="comment-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
    <div class="bg-cyber-800 border border-cyber-500 rounded-xl p-4 md:p-6 w-full max-w-lg glow-border animate-slide-up">
      <h3 class="font-display font-bold text-lg md:text-xl text-white mb-2 md:mb-4">Add Comment</h3>
      <p id="modal-item-title" class="text-cyber-200 mb-4 text-sm line-clamp-2"></p>
      <textarea id="comment-input" class="w-full h-32 rounded-lg p-3 font-mono text-sm resize-none" placeholder="Enter your notes, observations, or implementation details..."></textarea>
      <div class="flex justify-end gap-3 mt-4">
        <button onclick="closeCommentModal()" class="touch-target px-4 py-2 bg-cyber-700 hover:bg-cyber-600 border border-cyber-500 rounded-lg font-mono text-sm transition-all">Cancel</button>
        <button onclick="saveComment()" class="touch-target px-4 py-2 bg-accent-cyan/20 hover:bg-accent-cyan/30 border border-accent-cyan text-accent-cyan rounded-lg font-mono text-sm transition-all">Save</button>
      </div>
    </div>
  </div>

  <!-- Tips Panel -->
  <div id="tips-panel" class="fixed right-0 top-0 md:top-[73px] bottom-0 w-full md:w-96 bg-cyber-800 border-l border-cyber-600 transform translate-x-full transition-transform duration-300 z-50 md:z-40 overflow-y-auto scroll-container">
    <div class="p-4 md:p-6">
      <div class="flex items-center justify-between mb-4 md:mb-6 sticky top-0 bg-cyber-800 py-2 -mt-2">
        <h2 class="font-display font-bold text-lg text-white flex items-center gap-2">
          <svg class="w-5 h-5 text-accent-amber" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
          Tips & Guidance
        </h2>
        <button onclick="closeTipsPanel()" class="touch-target p-2 hover:bg-cyber-700 rounded-lg transition-colors">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>
      <div id="tips-content" class="space-y-4">
        <!-- Tips populated by JS -->
      </div>
    </div>
  </div>

<script>
// ============================================
// DATA DEFINITIONS
// ============================================

const securityData = {
  sections: [
    {
      id: "governance",
      title: "1. Governance & Pre-Deployment",
      shortTitle: "Governance",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>`,
      description: "Essential governance and authorization requirements before any technical implementation.",
      tips: [
        { title: "Executive Buy-in is Critical", content: "Without executive sponsorship, security initiatives often fail. Ensure you have documented risk acceptance from leadership." },
        { title: "Data Classification First", content: "You cannot protect what you haven't classified. Complete data classification before designing controls." },
        { title: "Legal Review is Non-Negotiable", content: "AI regulations are evolving rapidly. Ensure legal reviews GDPR, CCPA, HIPAA applicability, and emerging AI laws." },
        { title: "Document Everything", content: "Maintain audit trails of all governance decisions. This protects both the organization and individuals." }
      ],
      watchOuts: [
        "Don't skip governance to 'move fast' - this creates liability",
        "Ensure risk acceptance is formally documented, not verbal",
        "Review acceptable use policies with HR and Legal jointly",
        "Consider union/works council requirements in some jurisdictions"
      ],
      items: [
        { id: "gov-1", title: "Executive Sponsorship Obtained", description: "Written approval from CISO/CTO for local LLM deployment with documented business justification", priority: "critical" },
        { id: "gov-2", title: "Data Classification Completed", description: "All data types the LLM will process identified and classified (Public, Internal, Confidential, Restricted)", priority: "critical" },
        { id: "gov-3", title: "Legal/Compliance Review", description: "Legal sign-off obtained covering data residency, privacy laws, industry regulations, AI-specific laws", priority: "critical" },
        { id: "gov-4", title: "Acceptable Use Policy Drafted", description: "Policy defines permitted use cases, prohibited inputs, data handling requirements, user responsibilities", priority: "high" },
        { id: "gov-5", title: "Formal Risk Assessment", description: "Complete risk assessment covering technical, operational, compliance, and reputational risks", priority: "critical" }
      ]
    },
    {
      id: "threat-model",
      title: "2. Threat Modeling (Design First)",
      shortTitle: "Threat Modeling",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>`,
      description: "Systematic threat identification before implementation. Design security first, deploy second.",
      tips: [
        { title: "Use STRIDE Framework", content: "Spoofing, Tampering, Repudiation, Information Disclosure, DoS, Elevation of Privilege - address each systematically." },
        { title: "Build Attack Trees", content: "Visualize attack paths. This helps identify where controls provide the most value." },
        { title: "Consider LLM-Specific Threats", content: "Traditional threat models miss AI-specific risks like prompt injection, model extraction, and training data leakage." },
        { title: "Update Continuously", content: "Threat models are living documents. Review quarterly or after significant changes." }
      ],
      watchOuts: [
        "Don't treat threat modeling as a checkbox - it requires real analysis",
        "Include AI/ML experts in threat modeling sessions",
        "Consider insider threats, not just external attackers",
        "Model both the LLM system AND its integration points"
      ],
      items: [
        { id: "tm-1", title: "Asset Inventory Completed", description: "Documented all assets: model files, configs, training data, inference logs, prompts/responses", priority: "critical" },
        { id: "tm-2", title: "Trust Boundaries Mapped", description: "Defined boundaries between user space, LLM runtime, storage, network interfaces, external systems", priority: "critical" },
        { id: "tm-3", title: "STRIDE Analysis Complete", description: "Analyzed threats across all STRIDE categories for the LLM deployment", priority: "high" },
        { id: "tm-4", title: "Attack Trees Developed", description: "Created attack trees for model extraction, data exfiltration, prompt injection, adversarial inputs", priority: "high" },
        { id: "tm-5", title: "Security Requirements Derived", description: "Documented security requirements from threat model with risk scores and acceptance criteria", priority: "critical" }
      ]
    },
    {
      id: "attack-surface",
      title: "3. Attack Surface Analysis",
      shortTitle: "Attack Surface",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>`,
      description: "Identify and understand all potential attack vectors specific to local LLM deployments.",
      tips: [
        { title: "Model Layer is Unique", content: "Unlike traditional apps, the model itself is a valuable asset AND an attack vector. Protect model files like crown jewels." },
        { title: "Prompt Injection is Real", content: "This is the #1 LLM-specific vulnerability. Assume all user input is potentially malicious." },
        { title: "Output is Also Dangerous", content: "LLMs can leak training data or system information in outputs. Filter both inputs AND outputs." },
        { title: "Supply Chain Matters", content: "Pre-trained models may contain backdoors. Verify provenance of all model sources." }
      ],
      watchOuts: [
        "Model extraction attacks can occur through legitimate API access",
        "Conversation logs contain highly sensitive data - treat accordingly",
        "Adversarial inputs may not look malicious to traditional security tools",
        "Resource exhaustion attacks can be very expensive with GPU workloads"
      ],
      items: [
        { id: "as-1", title: "Model File Protection Assessed", description: "Evaluated risk of model theft/tampering and implemented appropriate controls", priority: "critical" },
        { id: "as-2", title: "Prompt Injection Vectors Identified", description: "Mapped all input paths that could deliver prompt injection attacks", priority: "critical" },
        { id: "as-3", title: "Data Leakage Paths Analyzed", description: "Identified how sensitive data could leak via outputs, logs, or inference side-channels", priority: "high" },
        { id: "as-4", title: "Infrastructure Vectors Mapped", description: "Documented network, authentication, and system-level attack paths", priority: "high" },
        { id: "as-5", title: "Supply Chain Risks Evaluated", description: "Assessed risks from model sources, dependencies, and third-party components", priority: "critical" }
      ]
    },
    {
      id: "endpoint",
      title: "4. Endpoint Hardening (Laptops)",
      shortTitle: "Endpoint Security",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>`,
      description: "Security hardening for laptops running local LLM deployments.",
      tips: [
        { title: "FDE is Mandatory", content: "Full disk encryption (BitLocker/FileVault/LUKS) is non-negotiable for any device with LLM data." },
        { title: "TPM for Key Protection", content: "Use TPM 2.0 to bind encryption keys to hardware. This prevents offline attacks on stolen devices." },
        { title: "EDR Must Understand AI Workloads", content: "Configure EDR to not flag legitimate LLM inference as suspicious while detecting actual threats." },
        { title: "USB Controls Critical", content: "Model files can be exfiltrated via USB. Implement strict removable media controls." }
      ],
      watchOuts: [
        "GPU drivers and CUDA libraries need patching too - don't forget them",
        "LLM inference is resource-intensive - balance security monitoring with performance",
        "Secure Boot may conflict with some GPU drivers - test thoroughly",
        "Application allowlisting must include all LLM dependencies"
      ],
      items: [
        { id: "ep-1", title: "Full Disk Encryption Enabled", description: "BitLocker/FileVault/LUKS enabled with recovery keys escrowed in enterprise key management", priority: "critical" },
        { id: "ep-2", title: "Secure Boot Configured", description: "UEFI Secure Boot enabled with trusted boot chain, legacy boot disabled", priority: "critical" },
        { id: "ep-3", title: "TPM 2.0 Integrated", description: "Encryption keys bound to TPM, measured boot enabled", priority: "high" },
        { id: "ep-4", title: "EDR Deployed", description: "EDR with AI/ML threat detection deployed, behavioral monitoring configured for LLM processes", priority: "critical" },
        { id: "ep-5", title: "USB/Port Controls", description: "DLP for removable media, unauthorized USB blocked, all transfers logged", priority: "high" },
        { id: "ep-6", title: "Application Allowlisting", description: "Only approved LLM runtime and dependencies allowed to execute", priority: "high" }
      ]
    },
    {
      id: "server",
      title: "5. Server Hardening",
      shortTitle: "Server Security",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"/></svg>`,
      description: "Security hardening for protected servers hosting LLM deployments.",
      tips: [
        { title: "CIS Benchmarks as Baseline", content: "Use CIS benchmarks for your OS as a starting point. Add LLM-specific hardening on top." },
        { title: "Micro-Segmentation is Key", content: "LLM servers should be isolated even from other internal systems. Implement strict network segmentation." },
        { title: "Container Security if Applicable", content: "If containerized, use hardened base images, run as non-root, scan continuously for vulnerabilities." },
        { title: "Aggressive Patching", content: "Critical vulnerabilities must be patched within 24-72 hours. Maintain a rapid patching capability." }
      ],
      watchOuts: [
        "GPU servers have additional attack surface via GPU drivers/firmware",
        "AI frameworks (PyTorch, TensorFlow) have their own vulnerabilities - monitor them",
        "Container escapes are a real threat - use robust container runtime security",
        "Don't expose inference endpoints directly to the internet"
      ],
      items: [
        { id: "srv-1", title: "OS Hardening Applied", description: "CIS benchmarks applied, unnecessary services disabled, default accounts removed", priority: "critical" },
        { id: "srv-2", title: "Network Segmentation", description: "LLM server in dedicated VLAN/subnet with micro-segmentation and strict firewall rules", priority: "critical" },
        { id: "srv-3", title: "Container Security (if applicable)", description: "Hardened base images, non-root execution, resource limits, continuous vulnerability scanning", priority: "high" },
        { id: "srv-4", title: "Patch Management Process", description: "Critical within 24-72hrs, High within 7 days, Medium within 30 days", priority: "critical" },
        { id: "srv-5", title: "GPU Security Hardening", description: "GPU drivers patched, CUDA libraries updated, GPU memory isolation configured", priority: "high" }
      ]
    },
    {
      id: "access",
      title: "6. Access Control",
      shortTitle: "Access Control",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/></svg>`,
      description: "Authentication, authorization, and session management for LLM access.",
      tips: [
        { title: "MFA Everywhere", content: "Every access path - admin, API, UI - must require multi-factor authentication. No exceptions." },
        { title: "Least Privilege is Essential", content: "Users should only have access to the LLM capabilities they need. Implement granular RBAC." },
        { title: "API Keys are Credentials", content: "Treat API keys like passwords. Rotate regularly, store securely, monitor for leakage." },
        { title: "Session Security Matters", content: "Short timeouts, secure tokens, and revocation capability are essential for LLM interfaces." }
      ],
      watchOuts: [
        "Service accounts for LLM often have excessive privileges - audit them",
        "API keys in code repos are a common leak vector",
        "Consider just-in-time access for administrative functions",
        "Monitor for credential stuffing attacks on LLM endpoints"
      ],
      items: [
        { id: "ac-1", title: "MFA Required", description: "Multi-factor authentication for all access: admin, API, user interface. Hardware tokens for privileged accounts", priority: "critical" },
        { id: "ac-2", title: "RBAC Implemented", description: "Role-based access with least privilege. Defined roles: Admin, Operator, User, Auditor. Regular access reviews", priority: "critical" },
        { id: "ac-3", title: "API Authentication", description: "OAuth 2.0/OIDC for API access, API key rotation policy, per-user/key rate limiting", priority: "critical" },
        { id: "ac-4", title: "Session Management", description: "15-30 min idle timeout, secure session tokens, session revocation capability", priority: "high" },
        { id: "ac-5", title: "Privileged Access Management", description: "PAM solution for admin access, just-in-time access, privileged session recording", priority: "high" }
      ]
    },
    {
      id: "data-protection",
      title: "7. Data Protection",
      shortTitle: "Data Protection",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"/></svg>`,
      description: "Encryption, key management, and data loss prevention for LLM deployments.",
      tips: [
        { title: "Encrypt Everything", content: "Model files, logs, conversations - all data at rest should be encrypted with AES-256." },
        { title: "TLS 1.3 Only", content: "For data in transit, enforce TLS 1.3. Disable older protocols that have known vulnerabilities." },
        { title: "Key Management is Critical", content: "Use HSM or secure key vault. Never store keys alongside encrypted data." },
        { title: "DLP for AI is Different", content: "Traditional DLP may not detect sensitive data in LLM outputs. Implement AI-aware DLP." }
      ],
      watchOuts: [
        "LLM prompts/responses may contain sensitive data that bypasses traditional DLP",
        "Key rotation must not interrupt service - plan carefully",
        "Backup encryption is often overlooked - don't forget it",
        "Consider retention requirements - some data must be kept, some must be deleted"
      ],
      items: [
        { id: "dp-1", title: "Encryption at Rest", description: "Model files, logs, conversation data encrypted with AES-256. Key rotation every 90 days minimum", priority: "critical" },
        { id: "dp-2", title: "Encryption in Transit", description: "TLS 1.3 enforced for all communications, older protocols disabled, certificate pinning for APIs", priority: "critical" },
        { id: "dp-3", title: "Key Management", description: "HSM or secure key vault in use, keys separated by function, key lifecycle documented", priority: "critical" },
        { id: "dp-4", title: "Data Loss Prevention", description: "DLP for LLM inputs/outputs, monitoring for sensitive data patterns (PII, PHI, credentials)", priority: "high" },
        { id: "dp-5", title: "Data Retention Policy", description: "Retention periods defined by data type, automated deletion, deletion logs for compliance", priority: "high" },
        { id: "dp-6", title: "Backup Security", description: "Backups encrypted, offline/air-gapped copies maintained, restoration tested quarterly", priority: "high" }
      ]
    },
    {
      id: "llm-security",
      title: "8. LLM-Specific Security",
      shortTitle: "LLM Security",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>`,
      description: "Security controls specific to Large Language Model deployments.",
      tips: [
        { title: "Model Integrity is Foundational", content: "Hash model files and verify before each load. A tampered model can be a backdoor." },
        { title: "Input Validation is Complex", content: "Unlike SQL injection, prompt injection can be subtle. Layer multiple detection approaches." },
        { title: "Output Filtering is Mandatory", content: "Scan all outputs for sensitive data, harmful content, and system information leakage." },
        { title: "Rate Limiting Prevents Extraction", content: "Limit query volume to prevent model extraction attacks through repeated inference." }
      ],
      watchOuts: [
        "New prompt injection techniques are discovered regularly - stay current",
        "System prompts can be extracted through clever prompting - protect them",
        "Model outputs may contain memorized training data - test for this",
        "Jailbreak attempts are constant - monitor and adapt defenses"
      ],
      items: [
        { id: "llm-1", title: "Model Integrity Verification", description: "SHA-256 hashes of model files calculated and verified, monitoring for unauthorized changes, alerts on mismatch", priority: "critical" },
        { id: "llm-2", title: "Input Validation", description: "All user inputs sanitized, character/token limits enforced, known prompt injection patterns filtered", priority: "critical" },
        { id: "llm-3", title: "Output Filtering", description: "Outputs scanned for sensitive data before delivery, content safety filters, harmful content blocked", priority: "critical" },
        { id: "llm-4", title: "Rate Limiting", description: "Per-user query limits, anomalous usage detection, model extraction prevention", priority: "high" },
        { id: "llm-5", title: "System Prompt Protection", description: "System prompts secured from extraction, leakage attempts monitored, separate privilege levels", priority: "high" },
        { id: "llm-6", title: "Sandboxing", description: "LLM runs in isolated environment, file system access restricted, network egress limited to approved endpoints", priority: "high" }
      ]
    },
    {
      id: "network",
      title: "9. Network Security",
      shortTitle: "Network",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>`,
      description: "Network security controls for LLM infrastructure.",
      tips: [
        { title: "Default Deny", content: "Start with all traffic blocked. Only allow what's explicitly needed for LLM operation." },
        { title: "Zero Trust Architecture", content: "Don't trust any connection. Verify device posture and user identity for every request." },
        { title: "Monitor for Exfiltration", content: "Large model files and conversation logs are attractive targets. Watch for unusual outbound data." },
        { title: "VPN for Remote Access", content: "Never expose LLM endpoints directly to the internet. Require VPN for all remote access." }
      ],
      watchOuts: [
        "LLM inference traffic patterns are unusual - tune IDS accordingly",
        "GPU-to-GPU communication may bypass traditional network monitoring",
        "Consider DNS-based exfiltration - LLM data can be encoded in DNS queries",
        "Cloud hybrid deployments add complexity - secure all connection points"
      ],
      items: [
        { id: "net-1", title: "Firewall Configuration", description: "Default deny all, only required ports/protocols allowed, application-layer filtering", priority: "critical" },
        { id: "net-2", title: "Network Monitoring", description: "IDS/IPS deployed, anomalous traffic detection, data exfiltration indicators monitored", priority: "high" },
        { id: "net-3", title: "VPN/Zero Trust", description: "VPN required for remote access, Zero Trust architecture, device posture verification", priority: "high" },
        { id: "net-4", title: "DNS Security", description: "DNS filtering, DNS-over-HTTPS/TLS, monitoring for DNS-based exfiltration", priority: "medium" }
      ]
    },
    {
      id: "compliance",
      title: "10. Legal & Compliance",
      shortTitle: "Compliance",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"/></svg>`,
      description: "Regulatory compliance requirements for LLM deployments.",
      tips: [
        { title: "GDPR Applies to LLMs", content: "User prompts are personal data. Ensure lawful basis, enable deletion rights, conduct DPIAs." },
        { title: "AI-Specific Laws Are Coming", content: "EU AI Act is here, others are following. Start compliance efforts now." },
        { title: "Industry Regulations Matter", content: "HIPAA, PCI-DSS, financial regulations - they all apply to LLM processing of regulated data." },
        { title: "Document Everything", content: "Regulators want to see evidence. Maintain detailed records of compliance efforts." }
      ],
      watchOuts: [
        "AI transparency requirements may conflict with security (prompt protection)",
        "Right to explanation may require understanding of LLM decision-making",
        "Cross-border data transfers are complex with AI - get legal advice",
        "Emerging state AI laws may have different requirements"
      ],
      items: [
        { id: "comp-1", title: "GDPR Compliance", description: "Lawful basis documented, data subject rights enabled, DPIAs completed, breach notification process ready", priority: "critical" },
        { id: "comp-2", title: "CCPA/CPRA Compliance", description: "Consumer rights processes, sensitive data handling, automated decision disclosure", priority: "high" },
        { id: "comp-3", title: "HIPAA Compliance (if applicable)", description: "PHI protection verified, BAAs in place, minimum necessary principle applied", priority: "critical" },
        { id: "comp-4", title: "EU AI Act Compliance", description: "Risk classification completed, human oversight for high-risk use, transparency requirements met", priority: "high" },
        { id: "comp-5", title: "SOC 2 / ISO 27001 Alignment", description: "LLM included in audit scope, AI-specific controls documented, evidence collection", priority: "medium" },
        { id: "comp-6", title: "OWASP LLM Top 10 Addressed", description: "All OWASP LLM risks evaluated and mitigated in implementation", priority: "high" }
      ]
    },
    {
      id: "monitoring",
      title: "11. Monitoring & Logging",
      shortTitle: "Monitoring",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>`,
      description: "Security monitoring, logging, and alerting for LLM systems.",
      tips: [
        { title: "Log Everything Securely", content: "Comprehensive logs are essential for incident response, but logs themselves contain sensitive data." },
        { title: "SIEM Integration is Critical", content: "Centralize logs for correlation. Create LLM-specific detection rules and dashboards." },
        { title: "Baseline Normal Behavior", content: "You can't detect anomalies without knowing what normal looks like. Establish baselines first." },
        { title: "Monitor Model Behavior", content: "Track output quality metrics. Unexpected changes may indicate tampering or drift." }
      ],
      watchOuts: [
        "Logging prompts/responses has privacy implications - balance security with privacy",
        "High inference volumes generate massive logs - plan storage accordingly",
        "Traditional SIEM rules won't detect LLM-specific attacks - create new ones",
        "Alert fatigue is real - tune thresholds carefully"
      ],
      items: [
        { id: "mon-1", title: "Authentication Logging", description: "All auth attempts logged (success/failure), MFA events, session creation/termination", priority: "critical" },
        { id: "mon-2", title: "Access Logging", description: "User identity, timestamp, action, resource, source IP logged. Minimum 1 year retention", priority: "critical" },
        { id: "mon-3", title: "Inference Logging", description: "Query metadata logged (user, time, token count). Privacy review for prompt content logging", priority: "high" },
        { id: "mon-4", title: "Security Event Logging", description: "Firewall events, IDS alerts, malware detections, policy violations, config changes captured", priority: "critical" },
        { id: "mon-5", title: "Log Protection", description: "Logs encrypted at rest, forwarded to SIEM in real-time, tamper-evident logging, restricted access", priority: "critical" },
        { id: "mon-6", title: "SIEM Integration", description: "All logs forwarded to SIEM, LLM-specific correlation rules, dashboards configured", priority: "high" },
        { id: "mon-7", title: "Anomaly Detection", description: "Normal behavior baselined, alerts on unusual patterns, volume spikes, off-hours access", priority: "high" }
      ]
    },
    {
      id: "incident",
      title: "12. Incident Response",
      shortTitle: "Incident Response",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
      description: "Incident response procedures for LLM security events.",
      tips: [
        { title: "Plan for LLM-Specific Incidents", content: "Model poisoning, prompt injection attacks, data leakage via outputs - these need specific playbooks." },
        { title: "Practice Makes Perfect", content: "Tabletop exercises reveal gaps. Practice LLM incident response before you need it." },
        { title: "Preserve Evidence Properly", content: "Model state, conversation logs, system memory - know how to capture LLM forensic evidence." },
        { title: "Communication is Key", content: "LLM incidents may require disclosure. Have a communication plan ready." }
      ],
      watchOuts: [
        "LLM incidents may be subtle - a poisoned model may produce subtly wrong outputs",
        "Traditional IR tools may not capture AI-relevant evidence",
        "Recovery from model poisoning may require full model replacement",
        "Regulatory notification timelines are short - be ready"
      ],
      items: [
        { id: "ir-1", title: "IR Plan for LLM", description: "LLM-specific incident scenarios documented, containment procedures, evidence preservation, communication plan", priority: "critical" },
        { id: "ir-2", title: "Containment Procedures", description: "Rapid shutdown procedure defined, network isolation process, user notification, evidence preservation steps", priority: "critical" },
        { id: "ir-3", title: "Forensics Capability", description: "Ability to capture memory dumps, model state, conversation logs, system logs for investigation", priority: "high" },
        { id: "ir-4", title: "Recovery Procedures", description: "Model restoration from trusted backup, integrity verification, staged return to service documented", priority: "high" },
        { id: "ir-5", title: "Post-Incident Review", description: "Root cause analysis process, threat model updates, lessons learned, stakeholder reporting", priority: "high" }
      ]
    },
    {
      id: "operations",
      title: "13. Operational Security",
      shortTitle: "Operations",
      icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>`,
      description: "Ongoing operational security procedures.",
      tips: [
        { title: "Change Management is Critical", content: "Model updates must go through rigorous change control. Test thoroughly before deployment." },
        { title: "Training is Ongoing", content: "Security awareness must include LLM-specific risks. Users need to understand prompt hygiene." },
        { title: "Supply Chain Never Stops", content: "Continuously monitor model sources and dependencies for new vulnerabilities." },
        { title: "Test Continuously", content: "Regular pentesting, red team exercises, and vulnerability scanning are essential." }
      ],
      watchOuts: [
        "Shadow AI - users may deploy unauthorized LLMs if official processes are too slow",
        "Model updates may change behavior in unexpected ways - regression test",
        "Third-party plugins/extensions for LLMs add risk - evaluate carefully",
        "Skills decay over time - regular refresher training is needed"
      ],
      items: [
        { id: "ops-1", title: "Model Update Process", description: "Approval workflow documented, isolated testing environment, integrity verification before deployment", priority: "critical" },
        { id: "ops-2", title: "Configuration Management", description: "All configs version controlled, changes require approval, rollback capability maintained", priority: "high" },
        { id: "ops-3", title: "Dependency Management", description: "All dependencies inventoried, vulnerability monitoring active, updates tested before deployment", priority: "high" },
        { id: "ops-4", title: "Security Training", description: "Users trained on secure usage, data handling, prompt hygiene, incident reporting. Annual refresher", priority: "high" },
        { id: "ops-5", title: "Admin Training", description: "Technical training completed: secure configuration, monitoring, incident response, forensics", priority: "high" },
        { id: "ops-6", title: "Model Provenance", description: "Source of model weights verified, licensing documented, chain of custody maintained", priority: "critical" },
        { id: "ops-7", title: "Penetration Testing", description: "Annual pentest including LLM-specific attacks (prompt injection, jailbreaking), findings remediated", priority: "high" },
        { id: "ops-8", title: "Vulnerability Scanning", description: "Weekly infrastructure scans, monthly application scans, continuous container scanning", priority: "high" }
      ]
    }
  ]
};

// ============================================
// STATE MANAGEMENT
// ============================================

let checklistState = {};
const STORAGE_KEY = 'llm-security-checklist-state';

function loadState() {
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) {
    try {
      checklistState = JSON.parse(saved);
    } catch (e) {
      checklistState = {};
    }
  }
  
  // Initialize any missing items
  securityData.sections.forEach(section => {
    section.items.forEach(item => {
      if (!checklistState[item.id]) {
        checklistState[item.id] = {
          completed: false,
          comment: ''
        };
      }
    });
  });
}

function saveState() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(checklistState));
  updateProgress();
  updateStats();
}

// ============================================
// UI RENDERING
// ============================================

function renderTOC() {
  const tocHTML = securityData.sections.map((section, idx) => `
    <button 
      onclick="scrollToSection('${section.id}')" 
      class="toc-item w-full text-left px-3 py-3 md:py-2 rounded-lg text-sm hover:bg-cyber-700 transition-colors flex items-center gap-3 touch-target"
      data-section="${section.id}"
    >
      <span class="text-cyber-300 flex-shrink-0">${section.icon}</span>
      <span class="truncate hidden md:inline">${section.title}</span>
      <span class="truncate md:hidden">${section.shortTitle}</span>
    </button>
  `).join('');
  
  // Desktop TOC
  const desktopNav = document.getElementById('toc-nav');
  if (desktopNav) desktopNav.innerHTML = tocHTML;
  
  // Mobile TOC
  const mobileNav = document.getElementById('mobile-toc-nav');
  if (mobileNav) mobileNav.innerHTML = tocHTML;
}

function renderSections() {
  const main = document.getElementById('main-content');
  main.innerHTML = securityData.sections.map(section => `
    <section id="section-${section.id}" class="mb-8 md:mb-12 animate-fade-in">
      <!-- Section Header -->
      <div class="flex flex-col md:flex-row md:items-start justify-between gap-4 mb-4 md:mb-6">
        <div class="flex items-start gap-3 md:gap-4">
          <div class="w-10 h-10 md:w-12 md:h-12 rounded-xl bg-gradient-to-br from-accent-cyan/20 to-accent-green/20 border border-accent-cyan/30 flex items-center justify-center text-accent-cyan flex-shrink-0">
            ${section.icon}
          </div>
          <div class="min-w-0">
            <h2 class="font-display font-bold text-lg md:text-2xl text-white leading-tight">${section.title}</h2>
            <p class="text-cyber-200 text-xs md:text-sm mt-1">${section.description}</p>
          </div>
        </div>
        <button 
          onclick="showTips('${section.id}')"
          class="touch-target w-full md:w-auto px-4 py-3 md:py-2 bg-accent-amber/10 hover:bg-accent-amber/20 border border-accent-amber/30 text-accent-amber rounded-lg text-sm font-mono transition-all flex items-center justify-center gap-2"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
          Tips & Watch Outs
        </button>
      </div>
      
      <!-- Checklist Items -->
      <div class="space-y-2 md:space-y-3">
        ${section.items.map(item => renderChecklistItem(item)).join('')}
      </div>
    </section>
  `).join('');
}

function renderChecklistItem(item) {
  const state = checklistState[item.id] || { completed: false, comment: '' };
  const priorityClass = `status-${item.priority}`;
  const completedClass = state.completed ? 'completed' : '';
  
  return `
    <div class="checklist-item ${completedClass} ${priorityClass} bg-cyber-800/50 rounded-lg p-3 md:p-4 border border-cyber-600 hover:border-cyber-500 transition-all" data-item-id="${item.id}">
      <div class="flex items-start gap-3 md:gap-4">
        <input 
          type="checkbox" 
          ${state.completed ? 'checked' : ''} 
          onchange="toggleItem('${item.id}')"
          class="mt-0.5 flex-shrink-0"
        >
        <div class="flex-1 min-w-0">
          <div class="flex flex-wrap items-center gap-2 mb-1">
            <h3 class="item-title font-display font-semibold text-sm md:text-base text-white">${item.title}</h3>
            <span class="px-2 py-0.5 rounded text-[10px] md:text-xs font-mono uppercase ${getPriorityBadgeClass(item.priority)}">${item.priority}</span>
          </div>
          <p class="text-cyber-200 text-xs md:text-sm leading-relaxed">${item.description}</p>
          
          ${state.comment ? `
            <div class="mt-2 md:mt-3 p-2 md:p-3 bg-cyber-900/50 rounded-lg border border-cyber-700">
              <div class="flex items-center gap-2 text-[10px] md:text-xs text-cyber-300 mb-1">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"/></svg>
                Comment
              </div>
              <p class="text-xs md:text-sm text-cyber-100 font-mono break-words">${escapeHtml(state.comment)}</p>
            </div>
          ` : ''}
        </div>
        
        <button 
          onclick="openCommentModal('${item.id}', '${escapeHtml(item.title)}')"
          class="touch-target flex-shrink-0 p-2 hover:bg-cyber-700 rounded-lg transition-colors text-cyber-300 hover:text-accent-cyan"
          title="Add/Edit Comment"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"/></svg>
        </button>
      </div>
    </div>
  `;
}

function getPriorityBadgeClass(priority) {
  switch(priority) {
    case 'critical': return 'bg-accent-red/20 text-accent-red border border-accent-red/30';
    case 'high': return 'bg-accent-amber/20 text-accent-amber border border-accent-amber/30';
    case 'medium': return 'bg-accent-purple/20 text-accent-purple border border-accent-purple/30';
    case 'low': return 'bg-accent-green/20 text-accent-green border border-accent-green/30';
    default: return 'bg-cyber-600 text-cyber-200';
  }
}

// ============================================
// MOBILE SIDEBAR
// ============================================

function toggleSidebar() {
  document.getElementById('mobile-sidebar').classList.toggle('active');
  document.getElementById('sidebar-overlay').classList.toggle('active');
  document.body.style.overflow = document.getElementById('mobile-sidebar').classList.contains('active') ? 'hidden' : '';
}

function closeSidebar() {
  document.getElementById('mobile-sidebar').classList.remove('active');
  document.getElementById('sidebar-overlay').classList.remove('active');
  document.body.style.overflow = '';
}

// ============================================
// INTERACTIONS
// ============================================

function toggleItem(itemId) {
  checklistState[itemId].completed = !checklistState[itemId].completed;
  saveState();
  
  // Update just this item's visual state
  const itemEl = document.querySelector(`[data-item-id="${itemId}"]`);
  if (itemEl) {
    itemEl.classList.toggle('completed', checklistState[itemId].completed);
  }
}

let currentCommentItemId = null;

function openCommentModal(itemId, itemTitle) {
  currentCommentItemId = itemId;
  document.getElementById('modal-item-title').textContent = itemTitle;
  document.getElementById('comment-input').value = checklistState[itemId]?.comment || '';
  document.getElementById('comment-modal').classList.remove('hidden');
  document.getElementById('comment-modal').classList.add('flex');
  setTimeout(() => document.getElementById('comment-input').focus(), 100);
}

function closeCommentModal() {
  document.getElementById('comment-modal').classList.add('hidden');
  document.getElementById('comment-modal').classList.remove('flex');
  currentCommentItemId = null;
}

function saveComment() {
  if (currentCommentItemId) {
    checklistState[currentCommentItemId].comment = document.getElementById('comment-input').value;
    saveState();
    renderSections(); // Re-render to show updated comment
    showToast('Comment saved', 'success');
  }
  closeCommentModal();
}

function showTips(sectionId) {
  const section = securityData.sections.find(s => s.id === sectionId);
  if (!section) return;
  
  const tipsContent = document.getElementById('tips-content');
  tipsContent.innerHTML = `
    <div class="mb-6">
      <h3 class="font-display font-semibold text-accent-cyan mb-3 flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
        Tips & Guidance
      </h3>
      ${section.tips.map(tip => `
        <div class="mb-3 p-3 bg-cyber-900/50 rounded-lg border border-cyber-700">
          <h4 class="font-semibold text-white text-sm mb-1">${tip.title}</h4>
          <p class="text-cyber-200 text-xs md:text-sm">${tip.content}</p>
        </div>
      `).join('')}
    </div>
    
    <div>
      <h3 class="font-display font-semibold text-accent-red mb-3 flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
        Watch Out For
      </h3>
      <ul class="space-y-2">
        ${section.watchOuts.map(wo => `
          <li class="flex items-start gap-2 text-xs md:text-sm text-cyber-200">
            <span class="text-accent-red mt-0.5 flex-shrink-0">â€¢</span>
            <span>${wo}</span>
          </li>
        `).join('')}
      </ul>
    </div>
  `;
  
  document.getElementById('tips-panel').classList.remove('translate-x-full');
  document.body.style.overflow = 'hidden';
}

function closeTipsPanel() {
  document.getElementById('tips-panel').classList.add('translate-x-full');
  document.body.style.overflow = '';
}

function scrollToSection(sectionId) {
  closeSidebar(); // Close mobile sidebar if open
  
  const section = document.getElementById(`section-${sectionId}`);
  if (section) {
    const headerOffset = window.innerWidth < 768 ? 70 : 90;
    const elementPosition = section.getBoundingClientRect().top;
    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
    
    window.scrollTo({
      top: offsetPosition,
      behavior: 'smooth'
    });
    
    // Update active TOC item
    document.querySelectorAll('.toc-item').forEach(item => {
      item.classList.toggle('active', item.dataset.section === sectionId);
    });
  }
}

// ============================================
// PROGRESS & STATS
// ============================================

function updateProgress() {
  let total = 0;
  let completed = 0;
  
  securityData.sections.forEach(section => {
    section.items.forEach(item => {
      total++;
      if (checklistState[item.id]?.completed) completed++;
    });
  });
  
  const percent = total > 0 ? Math.round((completed / total) * 100) : 0;
  
  // Desktop progress
  const desktopPercent = document.getElementById('progress-percent');
  if (desktopPercent) desktopPercent.textContent = `${percent}%`;
  
  // Mobile progress
  const mobilePercent = document.getElementById('mobile-progress-percent');
  if (mobilePercent) mobilePercent.textContent = `${percent}%`;
  
  // Update SVG circle
  const circle = document.getElementById('progress-circle');
  if (circle) circle.setAttribute('stroke-dasharray', `${percent}, 100`);
}

function updateStats() {
  const stats = { critical: { total: 0, done: 0 }, high: { total: 0, done: 0 }, medium: { total: 0, done: 0 }, low: { total: 0, done: 0 } };
  
  securityData.sections.forEach(section => {
    section.items.forEach(item => {
      if (stats[item.priority]) {
        stats[item.priority].total++;
        if (checklistState[item.id]?.completed) {
          stats[item.priority].done++;
        }
      }
    });
  });
  
  // Desktop stats
  const desktopIds = ['stat-critical', 'stat-high', 'stat-medium', 'stat-low'];
  desktopIds.forEach(id => {
    const el = document.getElementById(id);
    const key = id.replace('stat-', '');
    if (el && stats[key]) el.textContent = `${stats[key].done}/${stats[key].total}`;
  });
  
  // Mobile stats
  const mobileIds = ['mobile-stat-critical', 'mobile-stat-high', 'mobile-stat-medium', 'mobile-stat-low'];
  mobileIds.forEach(id => {
    const el = document.getElementById(id);
    const key = id.replace('mobile-stat-', '');
    if (el && stats[key]) el.textContent = `${stats[key].done}/${stats[key].total}`;
  });
}

// ============================================
// IMPORT/EXPORT
// ============================================

function exportData() {
  const exportObj = {
    version: '1.0',
    exportDate: new Date().toISOString(),
    checklistState: checklistState,
    metadata: {
      totalItems: Object.keys(checklistState).length,
      completedItems: Object.values(checklistState).filter(s => s.completed).length,
      itemsWithComments: Object.values(checklistState).filter(s => s.comment).length
    }
  };
  
  const blob = new Blob([JSON.stringify(exportObj, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `llm-security-checklist-${new Date().toISOString().split('T')[0]}.json`;
  a.click();
  URL.revokeObjectURL(url);
  
  showToast('Checklist exported successfully', 'success');
}

function importData(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = (e) => {
    try {
      const imported = JSON.parse(e.target.result);
      
      if (imported.checklistState) {
        // Merge imported state with existing structure
        Object.keys(imported.checklistState).forEach(key => {
          if (checklistState[key] !== undefined) {
            checklistState[key] = imported.checklistState[key];
          }
        });
        
        saveState();
        renderSections();
        showToast(`Imported ${imported.metadata?.completedItems || 0} completed items`, 'success');
      } else {
        showToast('Invalid file format', 'error');
      }
    } catch (err) {
      showToast('Failed to parse file', 'error');
    }
  };
  reader.readAsText(file);
  event.target.value = ''; // Reset file input
}

function resetData() {
  if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
    localStorage.removeItem(STORAGE_KEY);
    checklistState = {};
    loadState();
    renderSections();
    showToast('All progress reset', 'info');
  }
}

// ============================================
// UTILITIES
// ============================================

function escapeHtml(str) {
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
}

function showToast(message, type = 'info') {
  const container = document.getElementById('toast-container');
  const colors = {
    success: 'bg-accent-green/20 border-accent-green text-accent-green',
    error: 'bg-accent-red/20 border-accent-red text-accent-red',
    info: 'bg-accent-cyan/20 border-accent-cyan text-accent-cyan'
  };
  
  const toast = document.createElement('div');
  toast.className = `px-4 py-3 rounded-lg border ${colors[type]} font-mono text-sm animate-slide-up text-center md:text-left`;
  toast.textContent = message;
  container.appendChild(toast);
  
  setTimeout(() => {
    toast.style.opacity = '0';
    toast.style.transform = 'translateY(20px)';
    toast.style.transition = 'all 0.3s ease';
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

// Intersection observer for TOC highlighting
function setupScrollObserver() {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const sectionId = entry.target.id.replace('section-', '');
        document.querySelectorAll('.toc-item').forEach(item => {
          item.classList.toggle('active', item.dataset.section === sectionId);
        });
      }
    });
  }, { threshold: 0.1, rootMargin: '-80px 0px -70% 0px' });
  
  securityData.sections.forEach(section => {
    const el = document.getElementById(`section-${section.id}`);
    if (el) observer.observe(el);
  });
}

// Close modals on escape
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    closeCommentModal();
    closeTipsPanel();
    closeSidebar();
  }
});

// Handle back button for mobile panels
window.addEventListener('popstate', () => {
  closeTipsPanel();
  closeSidebar();
});

// ============================================
// INITIALIZATION
// ============================================

document.addEventListener('DOMContentLoaded', () => {
  loadState();
  renderTOC();
  renderSections();
  updateProgress();
  updateStats();
  setupScrollObserver();
});
</script>
</body>
</html>